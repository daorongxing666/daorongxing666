<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.1.1" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.1.1" type="image/png" sizes="32x32"><meta name="description" content="1.IP基本认识                           1.1 IP的基础概念       是位于网络层的一个协议，实现主机和主机之间的通信，也叫点对点通信。 通过源IP地址和目标IP地址这两个关键信息，在众多路由器的转发中实现通信。 路由器实现转发机制：当一台主机朝网络中发送数据包时，他会将目标IP地址设置为接收方的IP地址。随后传给本地网络">
<meta property="og:type" content="article">
<meta property="og:title" content="IP">
<meta property="og:url" content="https://www.arong.icu/post/44087/index.html">
<meta property="og:site_name" content="阿荣的个人博客">
<meta property="og:description" content="1.IP基本认识                           1.1 IP的基础概念       是位于网络层的一个协议，实现主机和主机之间的通信，也叫点对点通信。 通过源IP地址和目标IP地址这两个关键信息，在众多路由器的转发中实现通信。 路由器实现转发机制：当一台主机朝网络中发送数据包时，他会将目标IP地址设置为接收方的IP地址。随后传给本地网络">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683941331597-512b688a-8b33-485c-aa99-bd6e08ab3fc7.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683943728185-7e904a24-9f8d-4265-ab9f-ffec2396660f.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683943855883-a3824a6d-4e65-409d-9e71-288a8aba4383.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683944097408-4c2af274-7442-41a9-8887-35b78166b947.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683944728553-c93926e6-a4af-420c-9271-50aec45ffec9.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683945304497-91dcd42c-5f77-4fa1-bd88-da568ac9b76a.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683945345679-9ebd314f-7373-4b26-9c12-d90cbff0ae5f.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683945391428-3c09b4f0-cb38-4275-ab76-4ff05e647656.png">
<meta property="og:image" content="https://www.arong.icu/IP.assets/1683988940425-bd7992c7-d5fa-4512-b9ca-4f8eea22bb34.png">
<meta property="article:published_time" content="2023-03-24T01:15:12.000Z">
<meta property="article:modified_time" content="2023-09-07T04:17:12.222Z">
<meta property="article:author" content="Arong">
<meta property="article:tag" content="计算机网络">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.arong.icu/IP.assets/1683941331597-512b688a-8b33-485c-aa99-bd6e08ab3fc7.png"><title>IP | 阿荣的个人博客</title><link ref="canonical" href="https://www.arong.icu/post/44087/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.1.1"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":true},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"恭喜您，复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fa fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fa fa-folder-open"></i></span><span class="header-nav-menu-item__text">归档</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fa fa-layer-group"></i></span><span class="header-nav-menu-item__text">分类</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fa fa-tags"></i></span><span class="header-nav-menu-item__text">标签</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fa fa-user"></i></span><span class="header-nav-menu-item__text">博主</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/read/"><span class="header-nav-menu-item__icon"><i class="fa fa-book"></i></span><span class="header-nav-menu-item__text">阅读</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">IP</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="fa fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2023-03-24</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="fa fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2023-09-07</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="fa fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">3.6k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="fa fa-clock"></i></span><span class="post-meta-item__info">阅读时长</span><span class="post-meta-item__value">20分</span></span></div></header><div class="post-body">
        <h1 id="1-IP基本认识"   >
          <a href="#1-IP基本认识" class="heading-link"><i class="fas fa-link"></i></a>1.IP基本认识</h1>
      
        <h2 id="1-1-IP的基础概念"   >
          <a href="#1-1-IP的基础概念" class="heading-link"><i class="fas fa-link"></i></a>1.1 IP的基础概念</h2>
      <p>是位于网络层的一个协议，实现<strong>主机和主机之间的通信</strong>，也叫<strong>点对点通信</strong>。</p>
<p>通过<strong>源IP地址</strong>和<strong>目标IP地址</strong>这两个关键信息，在众多路由器的转发中实现通信。</p>
<p>路由器实现转发机制：当一台主机朝网络中发送数据包时，他会将目标IP地址设置为接收方的IP地址。随后传给<strong>本地网络</strong>，本地网络中的路由器通过检查数据包中的目标IP地址，并与自己的<strong>路由表</strong>进行匹配。如果发现目标ip地址时自己的网络，就会转发回去，否则，转发到路由表上对应的路由器。</p>
<p>具体转发机制：<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/145946764?utm_id=0" >https://zhuanlan.zhihu.com/p/145946764?utm_id=0</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="1-2-IP和MAC的区别"   >
          <a href="#1-2-IP和MAC的区别" class="heading-link"><i class="fas fa-link"></i></a>1.2 IP和MAC的区别</h2>
      <ul>
<li>位置不同：MAC位于数据链路层，IP位于网络层</li>
<li>管理内容不同：IP管理的是网络间两台<strong>没有直连</strong>主机之间的位置，数据链路层强调的是两台设备在物理意义上的<strong>直接连接</strong></li>
<li>也就是说，数据链路层可以是主机和路由器之间的连接，而IP只能是主机和主机之间的连接．而ip主机和主机之间的连接中间还隔了若干路由器。</li>
</ul>

        <h1 id="2-IP地址的基础知识"   >
          <a href="#2-IP地址的基础知识" class="heading-link"><i class="fas fa-link"></i></a>2.IP地址的基础知识</h1>
      
        <h2 id="2-1-IP地址的基础定义"   >
          <a href="#2-1-IP地址的基础定义" class="heading-link"><i class="fas fa-link"></i></a>2.1 IP地址的基础定义</h2>
      <p>在 TCP&#x2F;IP 网络通信时，为了保证能正常通信，每个设备都需要配置正确的 IP 地址，否则无法实现正常的通信。</p>
<p>针对IPV4协议的IP地址进行分析</p>

        <h3 id="点分十进制"   >
          <a href="#点分十进制" class="heading-link"><i class="fas fa-link"></i></a>点分十进制</h3>
      <p>IPV4协议中的IP地址是32位的，人类为了方便记忆，使用点分十进制的方法对ip地址进行了简化，即将32位IP地址每八位划分为1组，每组之间用点(<code>.</code>)隔开，再将每组都用十进制的方式表示出来。</p>
<p><img src="/IP.assets/1683941331597-512b688a-8b33-485c-aa99-bd6e08ab3fc7.png" alt="img"></p>

        <h2 id="2-2-IP地址的分类"   >
          <a href="#2-2-IP地址的分类" class="heading-link"><i class="fas fa-link"></i></a>2.2 IP地址的分类</h2>
      <p><img src="/IP.assets/1683943728185-7e904a24-9f8d-4265-ab9f-ffec2396660f.png" alt="img"></p>

        <h3 id="ABC类地址"   >
          <a href="#ABC类地址" class="heading-link"><i class="fas fa-link"></i></a>ABC类地址</h3>
      <p>ABC类地址由两个部分组成：<strong>网络号和主机号</strong>，前面的<code>0</code>,<code>10</code>,<code>110</code>是用于区分这三类地址的最快捷的方式。</p>
<p><img src="/IP.assets/1683943855883-a3824a6d-4e65-409d-9e71-288a8aba4383.png" alt="img"></p>
<p>其对应的最大主机数的计算公式为：<code>2n-2</code>, 其中n为主机号的位数。减去2的原因是因为有两个特殊ip地址不能够被使用：</p>
<ul>
<li>主机号全为 1 指定某个网络下的所有主机，用于<strong>广播</strong></li>
<li>主机号全为 0 指定某个网络</li>
</ul>

        <h3 id="DE类地址"   >
          <a href="#DE类地址" class="heading-link"><i class="fas fa-link"></i></a>DE类地址</h3>
      <p><img src="/IP.assets/1683944097408-4c2af274-7442-41a9-8887-35b78166b947.png" alt="img"></p>
<p>因为DE类地址中没有主机号，所以其不可以用于主机ip。</p>
<ul>
<li>224.0.0.0 ~ 224.0.0.255 为预留的组播地址，只能在局域网中，路由器是不会进行转发的。</li>
<li>224.0.1.0 ~ 238.255.255.255 为用户可用的组播地址，可以用于 Internet 上。</li>
<li>239.0.0.0 ~ 239.255.255.255 为本地管理组播地址，可供内部网在内部使用，仅在特定的本地范围内有效。</li>
</ul>
<p>广播和组播(多播)的区别：</p>
<p>广播：在一个局域网内，所有的IP地址都会收到这个信息，同一个链路中相互连接的主机之间发送数据包</p>
<p>组播：将信息发送给特定组内的所有主机，也就是说广播比组播的范围更加广泛，但是考虑到安全性的话，组播是更为优秀的。</p>
<p><strong>由于广播无法穿透路由，若想给其他网段发送同样的包，就可以使用可以穿透路由的多播。</strong></p>

        <h2 id="2-3-无分类地址-CIDR"   >
          <a href="#2-3-无分类地址-CIDR" class="heading-link"><i class="fas fa-link"></i></a>2.3 无分类地址 CIDR</h2>
      <p>针对于<strong>ABC类IP地址最大主机数分配不均匀</strong>的问题，提出了一种新的地址分类方式。</p>
<p>表示形式 a.b.c.d&#x2F;x，其中 &#x2F;x 表示前 x 位属于<strong>网络号</strong>， x 的范围是 0 ~ 32</p>
<p>子网掩码方式获取主机号：</p>
<p><img src="/IP.assets/1683944728553-c93926e6-a4af-420c-9271-50aec45ffec9.png" alt="img"></p>
<p>子网掩码还可以获取子网网络号，可以对网络层级做到进一步划分。</p>

        <h2 id="2-4-IP地址一些特性"   >
          <a href="#2-4-IP地址一些特性" class="heading-link"><i class="fas fa-link"></i></a>2.4 IP地址一些特性</h2>
      
        <h3 id="路由控制"   >
          <a href="#路由控制" class="heading-link"><i class="fas fa-link"></i></a>路由控制</h3>
      <p>计算机使用一个特殊的 IP 地址 <strong>127.0.0.1 作为环回地址</strong>。与该地址具有相同意义的是一个叫做 localhost 的主机名。使用这个 IP 或主机名时，数据包不会流向网络。</p>
<p>通过路由器和路由表，首先数据会先传到本地的路由器，其根据传输过来数据报文中的目标ip地址，对比自己的路由表，找到这份数据应该去向何方，并将其传向对应的路由器。</p>

        <h3 id="分片与重组"   >
          <a href="#分片与重组" class="heading-link"><i class="fas fa-link"></i></a>分片与重组</h3>
      <p>那么当 IP 数据包大小大于 MTU 时， IP 数据包就会被分片。</p>
<p>经过分片之后的 IP 数据报在被重组的时候，只能由目标主机进行，路由器是不会进行重组的。</p>
<p>在分片传输中，一旦某个分片丢失，则会造成整个 IP 数据报作废，所以 <code>TCP</code> 引入了<code>MSS</code>也就是在 TCP 层进行分片不由 IP 层分片，那么对于 <code>UDP</code> 我们尽量不要发送一个大于 <code>MTU</code> 的数据报文。</p>

        <h3 id="2-5-IPV6-amp-IPV4"   >
          <a href="#2-5-IPV6-amp-IPV4" class="heading-link"><i class="fas fa-link"></i></a>2.5 IPV6 &amp; IPV4</h3>
      <p>IPV6出现的原因：IPV4是<code>32</code>位的，其能够承受的IP地址只有232（约42亿）个IP地址，是远远不能够满足人类的需求的。所以，出现了具有<code>128</code>位的IPV6地址</p>

        <h3 id="IPV6的表示方式"   >
          <a href="#IPV6的表示方式" class="heading-link"><i class="fas fa-link"></i></a>IPV6的表示方式</h3>
      <p>每十六位为一个单位，用<code>:</code>分割开，如果出现连续的 0 时还可以将这些 0 省略，并用两个冒号 「::」隔开。但是，一个 IP 地址中只允许出现一次两个连续的冒号。</p>
<p><img src="/IP.assets/1683945304497-91dcd42c-5f77-4fa1-bd88-da568ac9b76a.png" alt="img"></p>

        <h3 id="IPV6的地址类型"   >
          <a href="#IPV6的地址类型" class="heading-link"><i class="fas fa-link"></i></a>IPV6的地址类型</h3>
      <p><img src="/IP.assets/1683945345679-9ebd314f-7373-4b26-9c12-d90cbff0ae5f.png" alt="img"></p>

        <h3 id="IPV4和IPV6首部的对比差异"   >
          <a href="#IPV4和IPV6首部的对比差异" class="heading-link"><i class="fas fa-link"></i></a>IPV4和IPV6首部的对比差异</h3>
      <p><img src="/IP.assets/1683945391428-3c09b4f0-cb38-4275-ab76-4ff05e647656.png" alt="img"></p>
<p>IPv6 相比 IPv4 的首部改进：</p>
<ul>
<li><strong>取消了首部校验和字段。</strong> 因为在数据链路层和传输层都会校验，因此 IPv6 直接取消了 IP 的校验。</li>
<li><strong>取消了分片&#x2F;重新组装相关字段。</strong> 分片与重组是耗时的过程，IPv6 不允许在中间路由器进行分片与重组，这种操作只能在源与目标主机，这将大大提高了路由器转发的速度。</li>
<li><strong>取消选项字段。</strong> 选项字段不再是标准 IP 首部的一部分了，但它并没有消失，而是可能出现在 IPv6 首部中的「下一个首部」指出的位置上。删除该选项字段使的 IPv6 的首部成为固定长度的 40 字节。</li>
</ul>

        <h1 id="3-IP相关协议技术"   >
          <a href="#3-IP相关协议技术" class="heading-link"><i class="fas fa-link"></i></a>3.IP相关协议技术</h1>
      
        <h2 id="3-1-DNS域名解析"   >
          <a href="#3-1-DNS域名解析" class="heading-link"><i class="fas fa-link"></i></a>3.1 DNS域名解析</h2>
      
        <h3 id="域名之间的层级关系"   >
          <a href="#域名之间的层级关系" class="heading-link"><i class="fas fa-link"></i></a>域名之间的层级关系</h3>
      <p>DNS中的域名是用<code>.</code>进行分割的，越往右边表示层级越高，如<code>www.baidu.com</code>表示一共有三个层级域名</p>
<p>分别为：<code>com</code>, <code>baidu.com</code>, <code>www.baidu.com</code></p>
<ul>
<li>根 DNS 服务器</li>
<li>顶级域 DNS 服务器（com）</li>
<li>权威 DNS 服务器（baidu.com）</li>
</ul>

        <h3 id="域名解析的全过程"   >
          <a href="#域名解析的全过程" class="heading-link"><i class="fas fa-link"></i></a>域名解析的全过程</h3>
      <p>浏览器首先看一下自己的缓存里有没有，如果没有就向操作系统的缓存要，还没有就检查本机域名解析文件 hosts，如果还是没有，就会 DNS 服务器进行查询，查询的过程如下：</p>
<ol>
<li>客户端向本地DNS服务器发送请求，询问目标域名的IP</li>
<li>本地DNS服务器收到客户端的请求后，在自己的缓存中查找，查找得到则直接返回，查找不到则向<strong>根域名服务器</strong>进行询问。</li>
</ol>
<p>根域名服务器是最高层次的，它不直接用于域名解析，但能指明一条道路。</p>
<ol>
<li>根域名服务器收到请求后，根据后缀找到<strong>顶级域名服务器地址</strong>，将其发给本地DNS服务器。</li>
<li>本地DNS服务器根据获得的顶级域名服务器地址，对其发送请求，顶级域名服务器地址将域名查询之后，发给客户端对应的<strong>权威DNS服务器</strong>地址。</li>
<li>本地DNS服务器根据获得的权威 DNS 服务器地址，对其发送请求，权威 DNS 服务器查询后将对应的 IP 地址 X.X.X.X 告诉本地 DNS。</li>
<li>本地 DNS 再将 IP 地址返回客户端，客户端和目标建立连接。</li>
</ol>
<p>总结：本地 DNS与若干DNS服务器的无限问答，以及本地DNS的无数次寻找，最后找到了IP地址。</p>

        <h2 id="3-2-ARP协议和RARP协议"   >
          <a href="#3-2-ARP协议和RARP协议" class="heading-link"><i class="fas fa-link"></i></a>3.2 ARP协议和RARP协议</h2>
      <ul>
<li>ARP：已知IP地址可以求得MAC地址</li>
<li>RARP：已知MAC地址可以求得IP地址</li>
</ul>

        <h3 id="ARP协议如何得知MAC地址"   >
          <a href="#ARP协议如何得知MAC地址" class="heading-link"><i class="fas fa-link"></i></a>ARP协议如何得知MAC地址</h3>
      <ul>
<li>主机会通过<strong>广播发送 ARP 请求</strong>，这个包中包含了想要知道的 MAC 地址的主机 IP 地址。</li>
<li>当同个链路中的所有设备收到 ARP 请求时，会去拆开 ARP 请求包里的内容，如果 ARP 请求包中的目标 IP 地址与自己的 IP 地址一致，那么这个设备就将自己的 MAC 地址塞入 <strong>ARP 响应包</strong>返回给主机。</li>
</ul>
<p>操作系统通常会把第一次通过 ARP 获取的 MAC 地址缓存起来，以便下次直接从缓存中找到对应 IP 地址的 MAC 地址。</p>

        <h2 id="3-3-DHCP动态获取IP地址"   >
          <a href="#3-3-DHCP动态获取IP地址" class="heading-link"><i class="fas fa-link"></i></a>3.3 DHCP动态获取IP地址</h2>
      <ul>
<li>客户端首先发起 <strong>DHCP 发现报文（DHCP DISCOVER）</strong> 的 IP 数据报，由于客户端没有 IP 地址，也不知道 DHCP 服务器的地址，所以使用的是 UDP <strong>广播</strong>通信，其使用的广播目的地址是 <code>255.255.255.255</code>（端口 67） 并且使用<code>0.0.0.0</code>（端口 68） 作为源 IP 地址。DHCP 客户端将该 IP 数据报传递给链路层，链路层然后将帧广播到所有的网络中设备。</li>
<li>DHCP 服务器收到 DHCP 发现报文时，用 <strong>DHCP 提供报文（DHCP OFFER）</strong> 向客户端做出响应。该报文仍然使用 IP 广播地址 <code>255.255.255.255</code>，该报文信息携带服务器提供可租约的 IP 地址、子网掩码、默认网关、DNS 服务器以及 <strong>IP 地址租用期</strong>。</li>
<li>客户端收到一个或多个服务器的 DHCP 提供报文后，从中选择一个服务器，并向选中的服务器发送 <strong>DHCP 请求报文（DHCP REQUEST</strong>进行响应，回显配置的参数。</li>
<li>最后，服务端用 <strong>DHCP ACK 报文</strong>对 DHCP 请求报文进行响应，应答所要求的参数。</li>
</ul>
<p>一旦客户端收到 DHCP ACK 后，交互便完成了，并且客户端能够在租用期内使用 DHCP 服务器分配的 IP 地址。</p>
<p>简化来讲，就是客户端去求职BOSS海投，然后看上这个客户端的服务端就给他发送offer，这个offer告诉他我能给你提供的条件（没错，不用面试），然后客户端选来选去，最后只回了一家，签约成功。之后服务端在发个合同入职须知什么的，结束。这是多少人梦寐以求的状态。</p>
<p>如果租约的 DHCP IP 地址快期后，客户端会向服务器发送 DHCP 请求报文：</p>
<ul>
<li>服务器如果同意继续租用，则用 DHCP ACK 报文进行应答，客户端就会延长租期。</li>
<li>服务器如果不同意继续租用，则用 DHCP NACK 报文，客户端就要停止使用租约的 IP 地址。</li>
</ul>

        <h2 id="3-4-NAT网络地址转换"   >
          <a href="#3-4-NAT网络地址转换" class="heading-link"><i class="fas fa-link"></i></a>3.4 NAT网络地址转换</h2>
      <p><strong>两个私有 IP 地址都转换 IP 地址为统一的公有地址，但是以不同的端口号作为区分。</strong></p>
<p>生成一个 NAPT 路由器的转换表，就可以正确地转换地址跟端口的组合，令客户端 A、B 能同时与服务器之间进行通信。</p>
<p>这种转换表在 NAT 路由器上自动生成。例如，在 TCP 的情况下，建立 TCP 连接首次握手时的 SYN 包一经发出，就会生成这个表。而后又随着收到关闭连接时发出 FIN 包的确认应答从表中被删除。</p>
<p>缺点：</p>
<ul>
<li>外部无法主动与 NAT 内部服务器建立连接，因为 NAPT 转换表没有转换记录。</li>
<li>转换表的生成与转换操作都会产生性能开销。</li>
<li>通信过程中，如果 NAT 路由器重启了，所有的 TCP 连接都将被重置。</li>
</ul>

        <h2 id="3-5-ICMP互联网控制报文协议"   >
          <a href="#3-5-ICMP互联网控制报文协议" class="heading-link"><i class="fas fa-link"></i></a>3.5 ICMP互联网控制报文协议</h2>
      <p>ICMP 主要的功能包括：<strong>确认 IP 包是否成功送达目标地址、报告发送过程中 IP 包被废弃的原因和改善网络设置等。</strong></p>
<p><img src="/IP.assets/1683988940425-bd7992c7-d5fa-4512-b9ca-4f8eea22bb34.png" alt="img"></p>
<p>查询报文：回送请求和回送响应是查询报文的两种，主要的作用是用来确定发送的数据包是否到达对端的一种方式</p>
<p>差错报文：相当于我们平时编程语言中的异常</p>
<ul>
<li><p>目标不可达：类似于404，可能是网络不可达，可能是端口不可达，可能是主机不可达等</p>
</li>
<li><ul>
<li>网络不可达代码为 0</li>
<li>主机不可达代码为 1	</li>
<li>协议不可达代码为 2</li>
<li>端口不可达代码为 3</li>
<li>需要进行分片但设置了不分片位代码为 4</li>
</ul>
</li>
<li><p>原点抑制：使用低网速传输的时候可能会出现网络拥堵情况，这时发送一个原点抑制的报文，可以增大 IP 包的传输间隔，减少网络拥堵的情况。</p>
</li>
</ul>

        <h1 id="4-扩展知识"   >
          <a href="#4-扩展知识" class="heading-link"><i class="fas fa-link"></i></a>4.扩展知识</h1>
      
        <h2 id="4-1-ICMP具体工作原理"   >
          <a href="#4-1-ICMP具体工作原理" class="heading-link"><i class="fas fa-link"></i></a>4.1 ICMP具体工作原理</h2>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://xiaolincoding.com/network/4_ip/ping.html#ip%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%8A%A9%E6%89%8B-icmp-%E5%8D%8F%E8%AE%AE" >https://xiaolincoding.com/network/4_ip&#x2F;ping.html#ip%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%8A%A9%E6%89%8B-icmp-%E5%8D%8F%E8%AE%AE</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>不想写了。。。认认真真的看过了！</p>

        <h2 id="4-2-ping-127-0-0-1"   >
          <a href="#4-2-ping-127-0-0-1" class="heading-link"><i class="fas fa-link"></i></a>4.2 ping 127.0.0.1</h2>
      
        <h3 id="断网了还能ping的通127-0-0-1吗"   >
          <a href="#断网了还能ping的通127-0-0-1吗" class="heading-link"><i class="fas fa-link"></i></a>断网了还能ping的通127.0.0.1吗</h3>
      <p>可以，因为还没走出到网络，客户端发出网络请求会第一步先走到本地路由器，本地路由器如果判断是自己的本地地址就会直接返回，如果不是再去对比自己的路由表。本地路由器是不需要网络的，所以我们发现ping 127.0.0.1不需要联网</p>

        <h2 id="127-0-0-1-和-localhost-以及-0-0-0-0-有区别吗"   >
          <a href="#127-0-0-1-和-localhost-以及-0-0-0-0-有区别吗" class="heading-link"><i class="fas fa-link"></i></a>127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗</h2>
      <ul>
<li><code>localhost</code>是一个域名，相当于<code>baidu.com</code>, 其ip地址为127.0.0.1，所以意义上有区别但是实际使用是没什么区别的</li>
<li>0.0.0.0 , 表示本机上的<strong>所有IPV4地址</strong>。是ping不通的</li>
</ul>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="https://www.arong.icu">Arong</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="https://www.arong.icu/post/44087/">https://www.arong.icu/post/44087/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-cn" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://www.arong.icu/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/post/32766/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">数组</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/post/11079/"><span class="paginator-prev__text">2.LinkList</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-IP%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">
          1.IP基本认识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-IP%E7%9A%84%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">
          1.1 IP的基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-IP%E5%92%8CMAC%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.2.</span> <span class="toc-text">
          1.2 IP和MAC的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-IP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">
          2.IP地址的基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-IP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%9F%BA%E7%A1%80%E5%AE%9A%E4%B9%89"><span class="toc-number">2.1.</span> <span class="toc-text">
          2.1 IP地址的基础定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%88%86%E5%8D%81%E8%BF%9B%E5%88%B6"><span class="toc-number">2.1.1.</span> <span class="toc-text">
          点分十进制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-IP%E5%9C%B0%E5%9D%80%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">2.2.</span> <span class="toc-text">
          2.2 IP地址的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ABC%E7%B1%BB%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.1.</span> <span class="toc-text">
          ABC类地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DE%E7%B1%BB%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.2.</span> <span class="toc-text">
          DE类地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%97%A0%E5%88%86%E7%B1%BB%E5%9C%B0%E5%9D%80-CIDR"><span class="toc-number">2.3.</span> <span class="toc-text">
          2.3 无分类地址 CIDR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-IP%E5%9C%B0%E5%9D%80%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7"><span class="toc-number">2.4.</span> <span class="toc-text">
          2.4 IP地址一些特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E6%8E%A7%E5%88%B6"><span class="toc-number">2.4.1.</span> <span class="toc-text">
          路由控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%89%87%E4%B8%8E%E9%87%8D%E7%BB%84"><span class="toc-number">2.4.2.</span> <span class="toc-text">
          分片与重组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-IPV6-amp-IPV4"><span class="toc-number">2.4.3.</span> <span class="toc-text">
          2.5 IPV6 &amp; IPV4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPV6%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%96%B9%E5%BC%8F"><span class="toc-number">2.4.4.</span> <span class="toc-text">
          IPV6的表示方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPV6%E7%9A%84%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.4.5.</span> <span class="toc-text">
          IPV6的地址类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPV4%E5%92%8CIPV6%E9%A6%96%E9%83%A8%E7%9A%84%E5%AF%B9%E6%AF%94%E5%B7%AE%E5%BC%82"><span class="toc-number">2.4.6.</span> <span class="toc-text">
          IPV4和IPV6首部的对比差异</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-IP%E7%9B%B8%E5%85%B3%E5%8D%8F%E8%AE%AE%E6%8A%80%E6%9C%AF"><span class="toc-number">3.</span> <span class="toc-text">
          3.IP相关协议技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">
          3.1 DNS域名解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B1%82%E7%BA%A7%E5%85%B3%E7%B3%BB"><span class="toc-number">3.1.1.</span> <span class="toc-text">
          域名之间的层级关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E7%9A%84%E5%85%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">3.1.2.</span> <span class="toc-text">
          域名解析的全过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-ARP%E5%8D%8F%E8%AE%AE%E5%92%8CRARP%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.2.</span> <span class="toc-text">
          3.2 ARP协议和RARP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ARP%E5%8D%8F%E8%AE%AE%E5%A6%82%E4%BD%95%E5%BE%97%E7%9F%A5MAC%E5%9C%B0%E5%9D%80"><span class="toc-number">3.2.1.</span> <span class="toc-text">
          ARP协议如何得知MAC地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-DHCP%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96IP%E5%9C%B0%E5%9D%80"><span class="toc-number">3.3.</span> <span class="toc-text">
          3.3 DHCP动态获取IP地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-NAT%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.4.</span> <span class="toc-text">
          3.4 NAT网络地址转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-ICMP%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.5.</span> <span class="toc-text">
          3.5 ICMP互联网控制报文协议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86"><span class="toc-number">4.</span> <span class="toc-text">
          4.扩展知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-ICMP%E5%85%B7%E4%BD%93%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.1.</span> <span class="toc-text">
          4.1 ICMP具体工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-ping-127-0-0-1"><span class="toc-number">4.2.</span> <span class="toc-text">
          4.2 ping 127.0.0.1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%AD%E7%BD%91%E4%BA%86%E8%BF%98%E8%83%BDping%E7%9A%84%E9%80%9A127-0-0-1%E5%90%97"><span class="toc-number">4.2.1.</span> <span class="toc-text">
          断网了还能ping的通127.0.0.1吗</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#127-0-0-1-%E5%92%8C-localhost-%E4%BB%A5%E5%8F%8A-0-0-0-0-%E6%9C%89%E5%8C%BA%E5%88%AB%E5%90%97"><span class="toc-number">4.3.</span> <span class="toc-text">
          127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/myphoto.png" alt="avatar"></div><p class="sidebar-ov-author__text">道阻且长,行则将至</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://plus.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://twitter.com/" target="_blank" rel="noopener" data-popover="Twitter" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-twitter"></i></span></a><a class="sidebar-ov-social-item" href="https://youtube.com/" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">29</div><div class="sidebar-ov-state-item__name">归档</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">9</div><div class="sidebar-ov-state-item__name">分类</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">9</div><div class="sidebar-ov-state-item__name">标签</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-cn" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fa fa-heart"></i></span><span>Arong</span></div><div>加油！一起学习一起成长</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="/js/utils.js?v=2.1.1"></script><script src="/js/stun-boot.js?v=2.1.1"></script><script src="/js/scroll.js?v=2.1.1"></script><script src="/js/header.js?v=2.1.1"></script><script src="/js/sidebar.js?v=2.1.1"></script></body></html>